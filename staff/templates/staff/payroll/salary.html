{% extends 'users/base.html' %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-3" style="background-color: #080000;">
            <p class="m-2 text-white">
                <i class="fa fa-plus text-warning"></i>
                    Credit
            </p>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link" href="{%url 'credit-list' %}">
                        View
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'credit-create' %}">
                        Add
                    </a>
                </li>
            </ul>
            <p class="text-white m-2">
                <i class="fa fa-minus text-warning"></i> Debit
            </p>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link" href="{%url 'debit-list' %}">
                        View
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'debit-create' %}">
                        Add
                    </a>
                </li>
            </ul>
            <p class="text-white m-2">
                <i class="fa fa-minus text-warning"></i> Tax
            </p>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'tax-list' %}">
                        View
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'update-tax' %}">
                        Update
                    </a>
                </li>
            </ul>

            <p class="m-2 text-white">
                <i class="fa fa-bank text-warning"></i>
                Payroll
            </p>
            {% if last_period_generated %}
            <ul class="nav flex-column">
                <li class="nav-item">
                    {% if payroll_current_period != '' %}
                    <a class="nav-link" href="{% url 'payroll-view' payroll_current_period %}">
                        View
                    </a>
                    {% endif %}
                </li>
                <li class="nav-item">
                    <a class="nav-link"
                       data-toggle="modal"
                       data-target="#initialModal"
                       href="#">
                        Generate
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'regenerate-payroll' %}">
                        Regenerate
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'payroll-modify' %}" hidden>
                        Modify
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'start-pay' %}">
                        Pay
                    </a>
                </li>
            </ul>
            {% else %}
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link"
                       data-toggle="modal"
                       data-target="#initialModal"
                       href="#">
                        Generate
                    </a>
                </li>
            </ul>
            {% endif %}
            
            <hr class="dropdown-divider">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link"
                       href="{% url 'staff-home' %}">
                        <i class="fa fa-reply"></i>
                        Staff Home
                    </a>
                </li>
            </ul>
        </div>
        <div class="col-9 mt-3">
            <h3 class="text-center">Payroll Page</h3>
            <p class="text-danger text-right">Current Date: {% now 'jS \o\f M, Y' %}</p>
            <h5>The Payroll Process</h5>
            <p>This is established to manage payroll effectively by the Human Resource Department (HRD).</p>
            <p>The Payroll is of two parts: Salaries and Gratuity</p>
            <p>Salaries are processed every calendar month and includes:</p>
            <ul>
                <li>Taxes (PIT)</li>
                <li>Credit, Incentives and Bonus if any</li>
                <li>Salary</li>
                <li>Debit and Shortages and Repayments</li>
            </ul>
            <p>Meanwhile, Gratuity (Money accrued for a staff pending resignation or retirement) is a reserve earned 
                from performance and kept in a seperate database. Even though, it is recorded during salary payment, it is a seperated
                account but can only be processed under the payroll system. 
            </p>
            
            {% if last_period_generated %}
            <p class="text-danger text-right">Last Period Generated: {{last_period_generated}}</p>
            {% else %}
            <h4 class="text-primary">No Record in Payroll Database</h4>
            <hr>
            {% endif %}

            <p>Steps required for a successful payroll implementation</p>
            <ol>
                <li>Ensure Staff Profile is updated</li>
                <li><b>Add</b> Debit and Credit accordingly</li>
                <li><b>Update</b> tax</li>
                <li><b>Generate</b> Payroll</li>
                <li>If there are outstanding amount to be moved to Net Pay, and if approval is granted, use 
                    <b>modify</b> to implement staff by staff.</li>
                <li>If there is need to change any of the above before generate, then you will need to <b>regenerate</b>
                upon approval to do.</li>
            </ol>
            
            <p>
                It is recommended you generate payroll between 25th and before the end of the month.
                Payrolls are categorized according to period. A period is one month.
            </p>

        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" 
id="initialModal" 
data-backdrop="static" 
data-keyboard="false" 
tabindex="-1" 
aria-labelledby="staticBackdropLabel" 
aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="staticBackdropLabel">Generate Payroll</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
    <form action="{% url 'salary' %}" method="get">
        <div class="modal-body">
            {% if last_period_generated %}
          <p>The last generated payroll is for {{last_period_generated}}.</p>     
          {% endif %}
          <p>Current required payroll period will be 
              <span class="text-primary">{{next_period}}</span>,
            which is for {{next_month}}, {{the_year}}.
            </p>
          <div class="row">
            <div class="col">
                <div class="form-group">
                    <input class="form-control" type="text" name="period" value="{{next_period}}" hidden>      
                </div>
            </div>
              
          </div>
        </div>
        <div class="modal-footer">
            <button type="submit" class="btn btn-primary">Generate</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
    </form>
      </div>
    </div>
  </div>
{% endblock %}