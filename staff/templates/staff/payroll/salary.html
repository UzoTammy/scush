{% extends 'users/base.html' %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-3" style="background-color: #080000;">
            <p class="m-2 text-white">
                <i class="fa fa-plus text-warning"></i>
                    Credit
            </p>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link" href="{%url 'credit-list' %}">
                        View
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'credit-create' %}">
                        Add
                    </a>
                </li>
            </ul>
            <p class="text-white m-2">
                <i class="fa fa-minus text-warning"></i> Debit
            </p>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link" href="{%url 'debit-list' %}">
                        View
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'debit-create' %}">
                        Add
                    </a>
                </li>
            </ul>
            <p class="text-white m-2">
                <i class="fa fa-minus text-warning"></i> Tax
            </p>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'tax-list' %}">
                        View
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'update-tax' %}">
                        Update
                    </a>
                </li>
            </ul>

            <p class="m-2 text-white">
                <i class="fa fa-bank text-warning"></i>
                Payroll
            </p>
            {% if last_period_generated %}
            <ul class="nav flex-column">
                <li class="nav-item">
                    {% if payroll_current_period != '' %}
                    <a class="nav-link" href="{% url 'payroll-view' payroll_current_period %}">
                        View
                    </a>
                    {% endif %}
                </li>
                <li class="nav-item">
                    <a class="nav-link"
                       data-toggle="modal"
                       data-target="#initialModal"
                       href="#">
                        Generate
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'regenerate-payroll' %}">
                        Regenerate
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'payroll-modify' %}">
                        Modify
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{% url 'start-pay' %}">
                        Pay
                    </a>
                </li>
            </ul>
            {% else %}
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link"
                       data-toggle="modal"
                       data-target="#initialModal"
                       href="#">
                        Generate
                    </a>
                </li>
            </ul>
            {% endif %}
            <hr class="dropdown-divider">
            <p class="m-2 text-white">
                <i class="fa fa-file-pdf-o text-warning"></i>
                PDF
            </p>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link" data-toggle="modal"
                       data-target="#pdfPayrollModal">
                        Payroll for Bank
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link"
                       data-toggle="modal"
                       data-target="#pdfPayslipModal">
                        Payslip
                    </a>
                </li>
            </ul>
            <hr class="dropdown-divider">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link"
                       href="{% url 'staff-home' %}">
                        <i class="fa fa-reply"></i>
                        Staff Home
                    </a>
                </li>
            </ul>
        </div>
        <div class="col-9 mt-3">
            <h3 class="text-center">Payroll Page</h3>
            <p>Payroll Process</p>
            <ul>
                <li>Ensure Staff Profile is updated</li>
                <li><b>Add</b> Debit and Credit accordingly</li>
                <li><b>Generate</b> Payroll</li>
                <li>If exemptions are granted, use <b>modify</b> to update payroll</li>
                <li>If staff profile is to be changed after payroll is generated,
                you can go ahead and update the profile and then <b>regenerate</b> payroll</li>
            </ul>
            <p>
                It is recommended you generate payroll between 25th and before the end of the month.
                Before you generate payroll, you must update the employee profile, and add credits or debits where
                necessary. <span class="text-danger">However, should there be need for adjustment of the payroll,
                then you can regenerate.</span> Payrolls are categorized according to period. A period is one month.
            </p>

            <p class="text-danger">Current Date: {% now 'jS \o\f M, Y' %}</p>

            {% if last_period_generated %}
            <p>Last Period Generated: {{last_period_generated}}</p>
            {% else %}
            <h4 class="text-primary">No Record in Payroll Database</h4>
            <hr>
            {% endif %}

        </div>
    </div>
</div>


<!-- Modal -->
<div class="modal fade"
     id="initialModal"
     tabindex="-1"
     data-backdrop="static"
     aria-labelledby="initialModalLabel"
     aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content bg-dark text-white">
      <div class="modal-header">
        <h5 class="modal-title"
            id="initialModalLabel">
            Period for Payroll
        </h5>
        <button type="button"
                class="btn-close"
                data-dismiss="modal"
                aria-label="Close">
            <i class="fa fa-close"></i>
        </button>
      </div>
    <form action="">
        <div class="modal-body">
            <div class="row">
                <div class="col form-group">
                <label class="" for="formYear">Year</label>
                <select class="form-control form-control-sm" name="year" id="formYear">
                    {% for year in years %}
                    {% if forloop.counter == 2 %}
                    <option value="{{year}}" selected>{{year}}</option>
                    {% else %}
                    <option value="{{year}}">{{year}}</option>
                    {% endif %}
                    {% endfor %}
                </select>
            </div>
                <div class="col form-group">
                <label for="formMonth">Month</label>
                <select class="form-control form-control-sm" name="month" id="formMonth">
                    {% for key, value in months.items %}
                    {% if key == current_month %}
                        <option value="{{key}}" selected>{{value}}</option>
                    {% else %}
                        <option value="{{key}}">{{value}}</option>
                    {% endif %}
                    {% endfor %}
                </select>
            </div>
            </div>

        </div>
        <div class="modal-footer">
            <button type="submit"
                    class="btn btn-danger">
                Proceed
            </button>
            <button type="button"
                    class="btn btn-secondary"
                    data-dismiss="modal">
                Cancel
            </button>
        </div>
    </form>
    </div>
  </div>
</div>
{% endblock %}